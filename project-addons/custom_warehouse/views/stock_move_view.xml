<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="view_move_picking_form" model="ir.ui.view">
        <field name="name">stock.move.form</field>
        <field name="model">stock.move</field>
        <field name="inherit_id" ref="stock.view_move_picking_form"/>
        <field name="arch" type="xml">
            <field name="procure_method" position="after">
                <field name="rule_id"/>
                <field name="procurement_route_id"/>
                <field name="purchase_line_id"/>
                <field name="sale_line_id"/>
            </field>
            <field name="move_dest_ids" position="after">
                <field name="move_orig_ids" />
            </field>
        </field>
    </record>

    <record id="view_picking_move_tree_cw" model="ir.ui.view">
            <field name="name">stock.picking.move.tree</field>
            <field name="model">stock.move</field>
            <field eval="50" name="priority"/>
            <field name="arch" type="xml">
                <tree decoration-danger="state != 'done' and quantity_done > reserved_availability and show_reserved_availability"
                      decoration-muted="scrapped == True or state == 'cancel' or (state == 'done' and is_locked == True)" string="Stock Moves">
                    <field name="name" invisible="1"/>
                    <field name="picking_id"/>
                    <field name="date_expected" invisible="1"/>                    
                    <field name="picking_type_id" invisible="1"/>
                    <field name="location_id" />
                    <field name="location_dest_id"/>
                    <field name="scrapped" invisible="1"/>
                    <field name="picking_code" invisible="1"/>
                    <field name="product_type" invisible="1"/>
                    <field name="show_details_visible" invisible="1"/>
                    <field name="show_reserved_availability" invisible="1"/>
                    <field name="show_operations" invisible="1" readonly="1"/>
                    <field name="additional" invisible="1"/>
                    <field name="has_move_lines" invisible="1"/>
                    <field name="is_locked" invisible="1"/>
                    <field name="product_id" required="1" attrs="{'readonly': ['|', '&amp;', ('state', '!=', 'draft'), ('additional', '=', False), ('has_move_lines', '=', True)]}"/>
                    <field name="is_initial_demand_editable" invisible="1"/>
                    <field name="is_quantity_done_editable" invisible="1"/>
                    <field name="product_uom_qty" string="Initial Demand" attrs="{'readonly': [('is_initial_demand_editable', '=', False)]}"/>
                    <field name="reserved_availability" string="Reserved"/>
                    
                    <button name="apply_change_procurement" string="Contra Stock. Click: cambiar metodo de abastecimiento" 
                        attrs="{'invisible': [('procure_method', '=', 'make_to_order')]}" type="object" icon="fa-indent" />
                    <button name="apply_change_procurement" string="Contra Regla. Click: cambiar metodo de abastecimiento" 
                        attrs="{'invisible': [('procure_method', '=', 'make_to_stock')]}" type="object" icon="fa-link" />
                    
                    <field name="quantity_done" string="Done" attrs="{'readonly': [('is_quantity_done_editable', '=', False)]}"/>
                    <field name="product_uom" attrs="{'readonly': [('state', '!=', 'draft'), ('additional', '=', False)]}" options="{'no_open': True, 'no_create': True}" string="Unit of Measure" groups="product.group_uom"/>
                    <field name="procure_method" groups="base.group_no_one"/>
                    <field name="rule_id" groups="base.group_no_one"/>
                    
                    <field name="procurement_route_id" groups="base.group_no_one"/>
                    <!--field name="move_dest_ids" widget="many2many_tags" />
                    <field name="move_orig_ids" widget="many2many_tags"/-->
                        <field name="state" readonly="1"/>
                </tree>
            </field>
        </record>

    <record id="action_reassing_split_from_picking" model="ir.actions.server">
        <field name="name">Split por fecha</field>
        <field name="model_id" ref="stock.model_stock_move"/>
        <field name="binding_model_id" ref="stock.model_stock_move"/>
        <field name="state">code</field>
        <field name="code">
            records.reassing_split_from_picking()
        </field>
    </record>

     <record id="view_picking_move_tree" model="ir.ui.view">
        <field name="name">stock.picking.move.tree</field>
        <field name="model">stock.move</field>
        <field name="inherit_id" ref="stock.view_picking_move_tree"/>
        <field name="arch" type="xml">
            <field name="date_expected" position="replace">
                
                <field name="date_expected"
                       attrs="{'readonly': [('state', '=', ['done', 'cancel', 'draft'])]}"/>
            </field>
            <field name="reserved_availability" position="after">
                <field name="procure_method" invisible="1"/>
                <button name="apply_change_procurement" string="Contra Stock. Click: cambiar metodo de abastecimiento" 
                    attrs="{'invisible': [('procure_method', '=', 'make_to_order')]}" type="object" icon="fa-indent" />
                <button name="apply_change_procurement" string="Contra Regla. Click: cambiar metodo de abastecimiento"
                    attrs="{'invisible': [('procure_method', '=', 'make_to_stock')]}" type="object" icon="fa-link" />
            </field>
        </field>
    </record>
</odoo>
